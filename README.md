# Canvas Drawing Editor

[![npm version](https://img.shields.io/npm/v/canvas-drawing-editor.svg)](https://www.npmjs.com/package/canvas-drawing-editor)
[![GitHub](https://img.shields.io/github/license/typsusan-zzz/canvas-drawing-editor)](https://github.com/typsusan-zzz/canvas-drawing-editor)

[ä¸­æ–‡](#ä¸­æ–‡) | [English](#english)

**GitHub**: https://github.com/typsusan-zzz/canvas-drawing-editor

**NPM**: https://www.npmjs.com/package/canvas-drawing-editor

**åœ¨çº¿æ–‡æ¡£ / Documentation**: https://typsusan-zzz.github.io/canvas-drawing-editor/

---

<a name="ä¸­æ–‡"></a>
## ä¸­æ–‡

ä¸€ä¸ªå¼ºå¤§çš„åŸºäº Canvas çš„ç”»å¸ƒç¼–è¾‘å™¨ Web Componentï¼Œ**é›¶ä¾èµ–**ï¼Œæ”¯æŒ **Vue 2/3**ã€**React**ã€**Angular** å’Œ**åŸç”Ÿ HTML**ã€‚

### âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ¨ **ç»‘å›¾å·¥å…·** - ç”»ç¬”ã€çŸ©å½¢ã€åœ†å½¢ã€çº¿æ¡ã€ç®­å¤´ã€å¤šè¾¹å½¢ã€æ–‡æœ¬
- ğŸ–¼ï¸ **å›¾ç‰‡æ”¯æŒ** - å¯¼å…¥å’Œç¼–è¾‘å›¾ç‰‡ï¼Œæ”¯æŒäº®åº¦/å¯¹æ¯”åº¦/æ¨¡ç³Šç­‰æ»¤é•œ
- ğŸ” **ç¼©æ”¾å¹³ç§»** - é¼ æ ‡æ»šè½®ä»¥å…‰æ ‡ä¸ºä¸­å¿ƒç¼©æ”¾ï¼Œæ‹–æ‹½å¹³ç§»ç”»å¸ƒ
- â†©ï¸ **æ’¤é”€/é‡åš** - å®Œæ•´çš„å†å²è®°å½•æ”¯æŒï¼ˆCtrl+Z / Ctrl+Yï¼‰
- ğŸ“š **å›¾å±‚ç®¡ç†** - å›¾å±‚ä¸Šç§»/ä¸‹ç§»/ç½®é¡¶/ç½®åº•ï¼Œå¯è§æ€§å’Œé”å®šæ§åˆ¶
- ğŸ”— **ç»„åˆ/è§£ç»„** - å¤šé€‰å¯¹è±¡ç»„åˆï¼ˆCtrl+Gï¼‰å’Œè§£ç»„ï¼ˆCtrl+Shift+Gï¼‰
- ğŸ“ **å¯¹é½/åˆ†å¸ƒ** - å·¦/ä¸­/å³å¯¹é½ï¼Œæ°´å¹³/å‚ç›´åˆ†å¸ƒ
- ğŸ”¥ **çƒ­åŒºåŠŸèƒ½** - ç»™æ–‡æœ¬ç»‘å®šåŠ¨æ€å˜é‡ï¼Œå®ç°æ¨¡æ¿åŒ–åŠ¨æ€æ›¿æ¢
- ğŸ’¾ **å¯¼å…¥å¯¼å‡º** - JSON æ ¼å¼ä¿å­˜/åŠ è½½é¡¹ç›®ï¼ŒPNG æ ¼å¼å¯¼å‡º
- âš¡ **é›¶ä¾èµ–** - çº¯ JavaScript å®ç°ï¼Œæ— éœ€ React/Vue
- ğŸ›ï¸ **å¯é…ç½®** - é€šè¿‡ tool é…ç½®å¯¹è±¡æ˜¾ç¤º/éšè—ä»»æ„å·¥å…·
- ğŸ“¦ **è½»é‡çº§** - gzip åçº¦ 33KB
- ğŸ”„ **æ—‹è½¬æ§åˆ¶** - å¯¹è±¡æ—‹è½¬æ‰‹æŸ„ï¼Œæ”¯æŒè‡ªç”±æ—‹è½¬
- âš–ï¸ **ç­‰æ¯”ç¼©æ”¾** - Shift + æ‹–æ‹½è§’ç‚¹ä¿æŒå®½é«˜æ¯”
- â­ **æ›´å¤šå½¢çŠ¶** - æ˜Ÿå½¢ã€å¿ƒå½¢ã€ä¸‰è§’å½¢ã€è±å½¢ã€è´å¡å°”æ›²çº¿
- âœï¸ **çº¿æ¡æ ·å¼** - å®çº¿/è™šçº¿/ç‚¹çº¿æ ·å¼ï¼Œå•å‘/åŒå‘ç®­å¤´
- ğŸ–‹ï¸ **å¯Œæ–‡æœ¬** - æ”¯æŒéƒ¨åˆ†åŠ ç²—ã€éƒ¨åˆ†æ”¹è‰²ã€éƒ¨åˆ†æ–œä½“
- ğŸ¬ **Tween åŠ¨ç”»** - å¯¹è±¡å±æ€§è¿‡æ¸¡åŠ¨ç”»ï¼ˆä½ç½®ã€å¤§å°ã€é€æ˜åº¦ç­‰ï¼‰
- ğŸ“± **ç§»åŠ¨ç«¯æ”¯æŒ** - å•æŒ‡æ‹–æ‹½ã€åŒæŒ‡ç¼©æ”¾/æ—‹è½¬ã€é•¿æŒ‰é€‰æ‹©ã€å“åº”å¼å¸ƒå±€

### ğŸ“¦ å®‰è£…

```bash
npm install canvas-drawing-editor
```

### ğŸš€ ä½¿ç”¨æ–¹æ³•

#### åŸç”Ÿ HTML

```html
<!DOCTYPE html>
<html>
<head>
  <style>
    canvas-drawing-editor { width: 100%; height: 600px; display: block; }
  </style>
</head>
<body>
  <canvas-drawing-editor title="æˆ‘çš„ç”»æ¿"></canvas-drawing-editor>

  <script src="https://unpkg.com/canvas-drawing-editor/dist/canvas-drawing-editor.umd.js"></script>
</body>
</html>
```

#### Vue 3

```vue
<template>
  <canvas-drawing-editor
    title="Vue ç”»æ¿"
    style="width: 100%; height: 600px;"
  ></canvas-drawing-editor>
</template>

<script setup>
import 'canvas-drawing-editor';
</script>
```

**å¯é€‰é…ç½®ï¼š** å¦‚æœæ§åˆ¶å°å‡ºç° `Failed to resolve component: canvas-drawing-editor` è­¦å‘Šï¼Œå¯åœ¨ `vite.config.ts` ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®æ¥æ¶ˆé™¤è­¦å‘Šï¼š
```ts
export default defineConfig({
  vue: {
    template: {
      compilerOptions: {
        isCustomElement: (tag) => tag === 'canvas-drawing-editor'
      }
    }
  }
});
```

#### Vue 2

```javascript
// main.js
import 'canvas-drawing-editor'

// å¯é€‰ï¼šå¦‚éœ€æ¶ˆé™¤æ§åˆ¶å°è­¦å‘Š
// Vue.config.ignoredElements = ['canvas-drawing-editor']
```

```vue
<template>
  <canvas-drawing-editor
    title="Vue2 ç”»æ¿"
    style="width: 100%; height: 600px;"
  ></canvas-drawing-editor>
</template>
```

#### React

```tsx
import 'canvas-drawing-editor';

function App() {
  return (
    <canvas-drawing-editor
      title="React ç”»æ¿"
      style={{ width: '100%', height: '600px' }}
    />
  );
}
```

#### Angular

```typescript
// app.module.ts
import { NgModule, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';
import 'canvas-drawing-editor';

@NgModule({
  // ...
  schemas: [CUSTOM_ELEMENTS_SCHEMA]
})
export class AppModule { }
```

```html
<!-- app.component.html -->
<canvas-drawing-editor
  title="Angular ç”»æ¿"
  style="width: 100%; height: 600px;"
></canvas-drawing-editor>
```

### âš™ï¸ é…ç½®é¡¹

#### åŸºç¡€å±æ€§

| å±æ€§ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `title` | string | "Canvas Editor" | ç¼–è¾‘å™¨æ ‡é¢˜ |
| `lang` | string | "zh" | ç•Œé¢è¯­è¨€ï¼ˆ"zh" ä¸­æ–‡ï¼Œ"en" è‹±æ–‡ï¼‰ |
| `theme-color` | string | "#5450dc" | ä¸»é¢˜è‰²ï¼ˆå½±å“æŒ‰é’®ã€æ‚¬åœçŠ¶æ€ç­‰ï¼‰ |
| `initial-data` | string | - | åˆå§‹åŒ– JSON æ•°æ®ï¼ˆæ ¼å¼è§ä¸‹æ–¹ï¼‰ |
| `enable-hotzone` | boolean | false | æ˜¯å¦å¯ç”¨çƒ­åŒºåŠŸèƒ½ï¼ˆç®¡ç†å‘˜æ¨¡å¼ï¼‰ |
| `hotzone-data` | string | - | çƒ­åŒºå˜é‡æ•°æ®ï¼ˆJSON æ ¼å¼ï¼Œç”¨äºåŠ¨æ€æ›¿æ¢æ–‡æœ¬ï¼‰ |
| `tool-config` | string | - | å·¥å…·é…ç½®å¯¹è±¡ï¼ˆJSON æ ¼å¼ï¼Œè§ä¸‹æ–¹ï¼‰ |

#### å·¥å…·é…ç½®ï¼ˆtool-configï¼‰

æ¨èä½¿ç”¨ `tool-config` å±æ€§ç»Ÿä¸€é…ç½®å·¥å…·æ˜¾ç¤ºï¼š

```html
<canvas-drawing-editor
  tool-config='{"pencil":true,"rectangle":true,"circle":true,"line":true,"arrow":true,"polygon":true,"text":true,"image":true,"undo":true,"redo":true,"zoom":true,"download":true,"exportJson":true,"importJson":true,"clear":true,"color":true,"layers":true,"group":true,"align":true}'
></canvas-drawing-editor>
```

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `pencil` | boolean | true | ç”»ç¬”å·¥å…· |
| `rectangle` | boolean | true | çŸ©å½¢å·¥å…· |
| `circle` | boolean | true | åœ†å½¢å·¥å…· |
| `line` | boolean | true | çº¿æ¡å·¥å…· |
| `arrow` | boolean | true | ç®­å¤´å·¥å…· |
| `polygon` | boolean | true | å¤šè¾¹å½¢å·¥å…· |
| `text` | boolean | true | æ–‡æœ¬å·¥å…· |
| `image` | boolean | true | å›¾ç‰‡å¯¼å…¥ |
| `undo` | boolean | true | æ’¤é”€æŒ‰é’® |
| `redo` | boolean | true | é‡åšæŒ‰é’® |
| `zoom` | boolean | true | ç¼©æ”¾æ§åˆ¶ |
| `download` | boolean | true | PNG å¯¼å‡º |
| `exportJson` | boolean | true | JSON ä¿å­˜ |
| `importJson` | boolean | true | JSON åŠ è½½ |
| `clear` | boolean | true | æ¸…ç©ºç”»å¸ƒ |
| `color` | boolean | true | é¢œè‰²é€‰æ‹©å™¨ |
| `layers` | boolean | true | å›¾å±‚ç®¡ç† |
| `group` | boolean | true | ç»„åˆ/è§£ç»„ |
| `align` | boolean | true | å¯¹é½/åˆ†å¸ƒ |

#### æ—§ç‰ˆå±æ€§ï¼ˆå‘åå…¼å®¹ï¼‰

ä»æ”¯æŒå•ç‹¬çš„ `show-*` å±æ€§ï¼Œä½†æ¨èä½¿ç”¨ `tool-config`ï¼š

| å±æ€§ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `show-pencil` | boolean | true | æ˜¾ç¤ºç”»ç¬”å·¥å…· |
| `show-rectangle` | boolean | true | æ˜¾ç¤ºçŸ©å½¢å·¥å…· |
| `show-circle` | boolean | true | æ˜¾ç¤ºåœ†å½¢å·¥å…· |
| `show-line` | boolean | true | æ˜¾ç¤ºçº¿æ¡å·¥å…· |
| `show-arrow` | boolean | true | æ˜¾ç¤ºç®­å¤´å·¥å…· |
| `show-polygon` | boolean | true | æ˜¾ç¤ºå¤šè¾¹å½¢å·¥å…· |
| `show-text` | boolean | true | æ˜¾ç¤ºæ–‡æœ¬å·¥å…· |
| `show-image` | boolean | true | æ˜¾ç¤ºå›¾ç‰‡å¯¼å…¥ |
| `show-undo` | boolean | true | æ˜¾ç¤ºæ’¤é”€æŒ‰é’® |
| `show-redo` | boolean | true | æ˜¾ç¤ºé‡åšæŒ‰é’® |
| `show-zoom` | boolean | true | æ˜¾ç¤ºç¼©æ”¾æ§åˆ¶ |
| `show-download` | boolean | true | æ˜¾ç¤º PNG å¯¼å‡º |
| `show-export` | boolean | true | æ˜¾ç¤º JSON ä¿å­˜ |
| `show-import` | boolean | true | æ˜¾ç¤º JSON åŠ è½½ |
| `show-color` | boolean | true | æ˜¾ç¤ºé¢œè‰²é€‰æ‹©å™¨ |
| `show-clear` | boolean | true | æ˜¾ç¤ºæ¸…ç©ºç”»å¸ƒæŒ‰é’® |
| `show-layers` | boolean | true | æ˜¾ç¤ºå›¾å±‚ç®¡ç† |
| `show-group` | boolean | true | æ˜¾ç¤ºç»„åˆ/è§£ç»„ |
| `show-align` | boolean | true | æ˜¾ç¤ºå¯¹é½/åˆ†å¸ƒ |

### ğŸ“Š åˆå§‹åŒ–æ•°æ®

å¯ä»¥é€šè¿‡ `initial-data` å±æ€§ä¼ å…¥ JSON æ•°æ®æ¥åˆå§‹åŒ–ç”»å¸ƒå†…å®¹ï¼š

```html
<canvas-drawing-editor
  initial-data='{"objects":[{"id":"abc123","type":"RECTANGLE","x":100,"y":100,"width":200,"height":150,"color":"#3b82f6","lineWidth":2}]}'
></canvas-drawing-editor>
```

### ğŸ“¡ äº‹ä»¶ç›‘å¬

#### `editor-change` äº‹ä»¶

å½“ç”»å¸ƒå†…å®¹å˜åŒ–æ—¶è§¦å‘ã€‚`e.detail.objects` æ•°ç»„åŒ…å«æ‰€æœ‰ç»‘å›¾å¯¹è±¡ã€‚

```javascript
document.addEventListener('editor-change', (e) => {
  console.log('å¯¹è±¡åˆ—è¡¨:', e.detail.objects);
  // ä¿å­˜åˆ°æœåŠ¡å™¨æˆ– localStorage
  localStorage.setItem('canvas-data', JSON.stringify({ objects: e.detail.objects }));
});
```

#### å¯¹è±¡ç±»å‹å’Œå±æ€§è¯´æ˜

`e.detail.objects` ä¸­æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä»¥ä¸‹åŸºç¡€å±æ€§ï¼š

| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `id` | string | å”¯ä¸€æ ‡è¯†ç¬¦ |
| `type` | string | å¯¹è±¡ç±»å‹ï¼š`RECTANGLE`ã€`CIRCLE`ã€`PATH`ã€`TEXT`ã€`RICH_TEXT`ã€`IMAGE`ã€`LINE`ã€`ARROW`ã€`POLYGON`ã€`TRIANGLE`ã€`STAR`ã€`HEART`ã€`DIAMOND`ã€`BEZIER`ã€`GROUP` |
| `rotation` | number | æ—‹è½¬è§’åº¦ï¼ˆå¼§åº¦ï¼Œå¯é€‰ï¼Œé»˜è®¤ 0ï¼‰ |
| `opacity` | number | é€æ˜åº¦ï¼ˆ0-1ï¼Œå¯é€‰ï¼Œé»˜è®¤ 1ï¼‰ |
| `x` | number | X åæ ‡ |
| `y` | number | Y åæ ‡ |
| `color` | string | æè¾¹/å¡«å……é¢œè‰²ï¼ˆåå…­è¿›åˆ¶æ ¼å¼ï¼Œå¦‚ `#3b82f6`ï¼‰ |
| `lineWidth` | number | çº¿æ¡å®½åº¦ï¼ˆåƒç´ ï¼‰ |
| `visible` | boolean | æ˜¯å¦å¯è§ï¼ˆå¯é€‰ï¼Œé»˜è®¤ trueï¼‰ |
| `locked` | boolean | æ˜¯å¦é”å®šï¼ˆå¯é€‰ï¼Œé»˜è®¤ falseï¼‰ |

**çŸ©å½¢** (`type: "RECTANGLE"`)ï¼š
| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `width` | number | çŸ©å½¢å®½åº¦ |
| `height` | number | çŸ©å½¢é«˜åº¦ |

**åœ†å½¢** (`type: "CIRCLE"`)ï¼š
| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `radius` | number | åœ†å½¢åŠå¾„ |

**ç”»ç¬”è·¯å¾„** (`type: "PATH"`)ï¼š
| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `points` | Array<{x, y}> | ç‚¹åæ ‡æ•°ç»„ |

**çº¿æ¡** (`type: "LINE"`)ï¼š
| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `x2` | number | ç»ˆç‚¹ X åæ ‡ |
| `y2` | number | ç»ˆç‚¹ Y åæ ‡ |

**ç®­å¤´** (`type: "ARROW"`)ï¼š
| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `x2` | number | ç»ˆç‚¹ X åæ ‡ |
| `y2` | number | ç»ˆç‚¹ Y åæ ‡ |

**å¤šè¾¹å½¢** (`type: "POLYGON"`)ï¼š
| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `radius` | number | å¤–æ¥åœ†åŠå¾„ |
| `sides` | number | è¾¹æ•°ï¼ˆå¦‚ 3=ä¸‰è§’å½¢ï¼Œ6=å…­è¾¹å½¢ï¼‰ |

**æ–‡æœ¬** (`type: "TEXT"`)ï¼š
| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `text` | string | æ–‡æœ¬å†…å®¹ |
| `fontSize` | number | å­—ä½“å¤§å°ï¼ˆåƒç´ ï¼‰ |
| `fontFamily` | string | å­—ä½“ï¼ˆå¯é€‰ï¼Œé»˜è®¤ sans-serifï¼‰ |
| `bold` | boolean | æ˜¯å¦åŠ ç²—ï¼ˆå¯é€‰ï¼‰ |
| `italic` | boolean | æ˜¯å¦æ–œä½“ï¼ˆå¯é€‰ï¼‰ |
| `hotzone` | object | çƒ­åŒºé…ç½®ï¼ˆå¯é€‰ï¼Œè¯¦è§ä¸‹æ–¹çƒ­åŒºåŠŸèƒ½ï¼‰ |

**å›¾ç‰‡** (`type: "IMAGE"`)ï¼š
| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `width` | number | å›¾ç‰‡å®½åº¦ |
| `height` | number | å›¾ç‰‡é«˜åº¦ |
| `dataUrl` | string | Base64 ç¼–ç çš„å›¾ç‰‡æ•°æ® |

**ç»„åˆ** (`type: "GROUP"`)ï¼š
| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `width` | number | ç»„åˆå®½åº¦ |
| `height` | number | ç»„åˆé«˜åº¦ |
| `children` | Array | å­å¯¹è±¡æ•°ç»„ |

**å¯Œæ–‡æœ¬** (`type: "RICH_TEXT"`)ï¼š
| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `segments` | Array | æ–‡æœ¬æ®µè½æ•°ç»„ï¼Œæ¯æ®µåŒ…å« `text`, `color`, `bold`, `italic`, `fontSize` |
| `fontSize` | number | é»˜è®¤å­—ä½“å¤§å°ï¼ˆåƒç´ ï¼‰ |

**æ˜Ÿå½¢** (`type: "STAR"`)ï¼š
| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `outerRadius` | number | å¤–åœ†åŠå¾„ |
| `innerRadius` | number | å†…åœ†åŠå¾„ |
| `points` | number | æ˜Ÿå½¢è§’æ•°ï¼ˆé»˜è®¤ 5ï¼‰ |

**å¿ƒå½¢** (`type: "HEART"`)ã€**ä¸‰è§’å½¢** (`type: "TRIANGLE"`)ã€**è±å½¢** (`type: "DIAMOND"`)ï¼š
| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `width` | number | å®½åº¦ |
| `height` | number | é«˜åº¦ |

**è´å¡å°”æ›²çº¿** (`type: "BEZIER"`)ï¼š
| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `points` | Array | æ§åˆ¶ç‚¹æ•°ç»„ï¼ˆåŒ…å«é”šç‚¹å’Œæ§åˆ¶æŸ„ï¼‰ |
| `closed` | boolean | æ˜¯å¦é—­åˆè·¯å¾„ |

#### ç¤ºä¾‹ï¼šä¿å­˜å’ŒåŠ è½½ç”»å¸ƒ

```javascript
// ä¿å­˜ç”»å¸ƒå†…å®¹
document.addEventListener('editor-change', (e) => {
  const data = JSON.stringify({ objects: e.detail.objects });
  localStorage.setItem('my-canvas', data);
});

// åŠ è½½ç”»å¸ƒå†…å®¹
const savedData = localStorage.getItem('my-canvas');
if (savedData) {
  document.querySelector('canvas-drawing-editor').setAttribute('initial-data', savedData);
}
```

#### `editor-close` äº‹ä»¶

```javascript
document.addEventListener('editor-close', () => {
  console.log('ç¼–è¾‘å™¨å·²å…³é—­');
});
```

#### `animation-start` äº‹ä»¶

å½“åŠ¨ç”»å¼€å§‹æ—¶è§¦å‘ã€‚

```javascript
document.addEventListener('animation-start', (e) => {
  console.log('åŠ¨ç”»å¼€å§‹:', e.detail);
  // e.detail: { tweenId, objectId }
});
```

#### `animation-complete` äº‹ä»¶

å½“åŠ¨ç”»å®Œæˆæ—¶è§¦å‘ã€‚

```javascript
document.addEventListener('animation-complete', (e) => {
  console.log('åŠ¨ç”»å®Œæˆ:', e.detail);
  // e.detail: { tweenId, objectId }
});
```

#### `animation-update` äº‹ä»¶

åŠ¨ç”»æ¯å¸§æ›´æ–°æ—¶è§¦å‘ã€‚

```javascript
document.addEventListener('animation-update', (e) => {
  console.log('åŠ¨ç”»è¿›åº¦:', e.detail.progress);
  // e.detail: { tweenId, objectId, progress }
});
```

### ğŸ”¥ çƒ­åŒºåŠŸèƒ½

çƒ­åŒºåŠŸèƒ½å…è®¸ä½ ç»™æ–‡æœ¬å¯¹è±¡ç»‘å®šåŠ¨æ€å˜é‡ï¼Œå®ç°æ¨¡æ¿åŒ–çš„åŠ¨æ€æ–‡æœ¬æ›¿æ¢ã€‚

#### ä½¿ç”¨åœºæ™¯

1. è®¾è®¡æ¨¡æ¿ï¼ˆå¦‚è¯ä¹¦ã€åç‰‡ã€æµ·æŠ¥ï¼‰
2. ç»™æ–‡æœ¬æ·»åŠ çƒ­åŒºï¼Œç»‘å®šå˜é‡å
3. ä½¿ç”¨æ—¶ä¼ å…¥å˜é‡å€¼ï¼ŒåŠ¨æ€æ›¿æ¢æ–‡æœ¬å†…å®¹

#### ç®¡ç†å‘˜ç«¯ï¼ˆè®¾è®¡æ¨¡æ¿ï¼‰

```html
<!-- å¯ç”¨çƒ­åŒºç¼–è¾‘åŠŸèƒ½ -->
<canvas-drawing-editor
  title="æ¨¡æ¿è®¾è®¡å™¨"
  enable-hotzone="true"
></canvas-drawing-editor>
```

æ“ä½œæ­¥éª¤ï¼š
1. åˆ›å»ºæ–‡æœ¬ï¼ˆå¦‚ï¼š"å§“å"ï¼‰
2. å³é”®ç‚¹å‡»æ–‡æœ¬ â†’ é€‰æ‹©ã€Œæ–°å»ºçƒ­åŒºã€
3. è¾“å…¥å˜é‡åï¼ˆå¦‚ï¼š`name`ï¼‰â†’ ä¿å­˜
4. å¯¼å‡º JSON ä¿å­˜æ¨¡æ¿

#### ç”¨æˆ·ç«¯ï¼ˆå±•ç¤ºåŠ¨æ€æ•°æ®ï¼‰

```html
<!-- ä¼ å…¥æ¨¡æ¿æ•°æ®å’Œå˜é‡å€¼ -->
<canvas-drawing-editor
  initial-data='{"objects":[...]}'
  hotzone-data='{"name": "å¼ ä¸‰", "company": "XXå…¬å¸"}'
></canvas-drawing-editor>
```

#### çƒ­åŒºæ•°æ®ç»“æ„

```javascript
// æ–‡æœ¬å¯¹è±¡çš„çƒ­åŒºé…ç½®
{
  "type": "TEXT",
  "text": "å§“å",
  "hotzone": {
    "variableName": "name",      // å˜é‡åï¼ˆå¿…å¡«ï¼‰
    "defaultValue": "é»˜è®¤å€¼",     // é»˜è®¤å€¼ï¼ˆå¯é€‰ï¼‰
    "description": "ç”¨æˆ·å§“å"     // æè¿°ï¼ˆå¯é€‰ï¼‰
  }
}
```

### ğŸ¬ Tween åŠ¨ç”» API

é€šè¿‡ `tweenAnimate()` æ–¹æ³•å¯ä»¥ä¸ºå¯¹è±¡åˆ›å»ºå¹³æ»‘çš„å±æ€§è¿‡æ¸¡åŠ¨ç”»ï¼š

```javascript
const editor = document.querySelector('canvas-drawing-editor');

// åŸºæœ¬ç”¨æ³•
editor.tweenAnimate(objectId, { x: 300, y: 200 }, {
  duration: 1000,        // åŠ¨ç”»æ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰
  easing: 'easeOutQuad', // ç¼“åŠ¨å‡½æ•°
  onComplete: () => console.log('åŠ¨ç”»å®Œæˆ')
});

// å¯åŠ¨ç”»å±æ€§ï¼šx, y, width, height, rotation, opacity, fontSize, radius

// ç¼“åŠ¨å‡½æ•°ï¼šlinear, easeInQuad, easeOutQuad, easeInOutQuad,
//          easeInElastic, easeOutElastic, easeInBounce, easeOutBounce,
//          easeInBack, easeOutBack

// å¾ªç¯åŠ¨ç”»
editor.tweenAnimate(objectId, { x: 400 }, {
  duration: 1000,
  repeat: -1,    // æ— é™å¾ªç¯
  yoyo: true     // å¾€è¿”
});

// åœæ­¢åŠ¨ç”»
editor.stopAllAnimations();
```

### ğŸ› ï¸ å¼€å‘

```bash
# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# æ„å»ºåº“
npm run build:lib
```

---

<a name="english"></a>
## English

A powerful canvas-based drawing editor Web Component with **zero dependencies**. Works with **Vue 2/3**, **React**, **Angular**, and **vanilla HTML**.

### âœ¨ Features

- ğŸ¨ **Drawing Tools** - Pencil, Rectangle, Circle, Line, Arrow, Polygon, Text
- ğŸ–¼ï¸ **Image Support** - Import and manipulate images with brightness/contrast/blur filters
- ğŸ” **Zoom & Pan** - Mouse wheel zoom centered on cursor, drag to pan
- â†©ï¸ **Undo/Redo** - Full history support (Ctrl+Z / Ctrl+Y)
- ğŸ“š **Layer Management** - Move up/down/top/bottom, visibility and lock control
- ğŸ”— **Group/Ungroup** - Multi-select and group objects (Ctrl+G / Ctrl+Shift+G)
- ğŸ“ **Align/Distribute** - Left/center/right alignment, horizontal/vertical distribution
- ğŸ”¥ **Hotzone** - Bind dynamic variables to text for template-based replacement
- ğŸ’¾ **Import/Export** - Save and load projects as JSON, export as PNG
- âš¡ **Zero Dependencies** - Pure JavaScript, no React/Vue required
- ğŸ›ï¸ **Configurable** - Show/hide any tool via tool config object
- ğŸ“¦ **Lightweight** - ~33KB gzipped
- ğŸ”„ **Rotation Control** - Object rotation handle for free rotation
- âš–ï¸ **Proportional Scaling** - Shift + drag corner to maintain aspect ratio
- â­ **More Shapes** - Star, Heart, Triangle, Diamond, Bezier curves
- âœï¸ **Line Styles** - Solid/dashed/dotted styles, single/double arrows
- ğŸ–‹ï¸ **Rich Text** - Support partial bold, partial color, partial italic
- ğŸ¬ **Tween Animation** - Object property transition animations (position, size, opacity, etc.)
- ğŸ“± **Mobile Support** - Single finger drag, two-finger zoom/rotate, long press selection, responsive layout

### ğŸ“¦ Installation

```bash
npm install canvas-drawing-editor
```

### ğŸš€ Usage

#### Vanilla HTML

```html
<!DOCTYPE html>
<html>
<head>
  <style>
    canvas-drawing-editor { width: 100%; height: 600px; display: block; }
  </style>
</head>
<body>
  <canvas-drawing-editor title="My Canvas"></canvas-drawing-editor>

  <script src="https://unpkg.com/canvas-drawing-editor/dist/canvas-drawing-editor.umd.js"></script>
</body>
</html>
```

#### Vue 3

```vue
<template>
  <canvas-drawing-editor
    title="Vue Canvas"
    style="width: 100%; height: 600px;"
  ></canvas-drawing-editor>
</template>

<script setup>
import 'canvas-drawing-editor';
</script>
```

**Optional:** To suppress the `Failed to resolve component: canvas-drawing-editor` warning in the console, add to `vite.config.ts`:
```ts
export default defineConfig({
  vue: {
    template: {
      compilerOptions: {
        isCustomElement: (tag) => tag === 'canvas-drawing-editor'
      }
    }
  }
});
```

#### Vue 2

```javascript
// main.js
import 'canvas-drawing-editor'

// Optional: To suppress console warnings
// Vue.config.ignoredElements = ['canvas-drawing-editor']
```

```vue
<template>
  <canvas-drawing-editor
    title="Vue2 Canvas"
    style="width: 100%; height: 600px;"
  ></canvas-drawing-editor>
</template>
```

#### React

```tsx
import 'canvas-drawing-editor';

function App() {
  return (
    <canvas-drawing-editor
      title="React Canvas"
      style={{ width: '100%', height: '600px' }}
    />
  );
}
```

#### Angular

```typescript
// app.module.ts
import { NgModule, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';
import 'canvas-drawing-editor';

@NgModule({
  // ...
  schemas: [CUSTOM_ELEMENTS_SCHEMA]
})
export class AppModule { }
```

```html
<!-- app.component.html -->
<canvas-drawing-editor
  title="Angular Canvas"
  style="width: 100%; height: 600px;"
></canvas-drawing-editor>
```

### âš™ï¸ Configuration

#### Basic Attributes

| Attribute | Type | Default | Description |
|-----------|------|---------|-------------|
| `title` | string | "Canvas Editor" | Editor title |
| `lang` | string | "zh" | UI language ("zh" for Chinese, "en" for English) |
| `theme-color` | string | "#5450dc" | Theme color (affects buttons, hover states, etc.) |
| `initial-data` | string | - | Initial JSON data to render (see format below) |
| `enable-hotzone` | boolean | false | Enable hotzone feature (admin mode) |
| `hotzone-data` | string | - | Hotzone variable data (JSON format for dynamic text replacement) |
| `tool-config` | string | - | Tool configuration object (JSON format, see below) |

#### Tool Configuration (tool-config)

Recommended: Use `tool-config` attribute for unified tool configuration:

```html
<canvas-drawing-editor
  tool-config='{"pencil":true,"rectangle":true,"circle":true,"line":true,"arrow":true,"polygon":true,"text":true,"image":true,"undo":true,"redo":true,"zoom":true,"download":true,"exportJson":true,"importJson":true,"clear":true,"color":true,"layers":true,"group":true,"align":true}'
></canvas-drawing-editor>
```

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `pencil` | boolean | true | Pencil tool |
| `rectangle` | boolean | true | Rectangle tool |
| `circle` | boolean | true | Circle tool |
| `line` | boolean | true | Line tool |
| `arrow` | boolean | true | Arrow tool |
| `polygon` | boolean | true | Polygon tool |
| `text` | boolean | true | Text tool |
| `image` | boolean | true | Image import |
| `undo` | boolean | true | Undo button |
| `redo` | boolean | true | Redo button |
| `zoom` | boolean | true | Zoom controls |
| `download` | boolean | true | PNG export |
| `exportJson` | boolean | true | JSON save |
| `importJson` | boolean | true | JSON load |
| `clear` | boolean | true | Clear canvas |
| `color` | boolean | true | Color picker |
| `layers` | boolean | true | Layer management |
| `group` | boolean | true | Group/Ungroup |
| `align` | boolean | true | Align/Distribute |

#### Legacy Attributes (Backward Compatible)

Individual `show-*` attributes are still supported but `tool-config` is recommended:

| Attribute | Type | Default | Description |
|-----------|------|---------|-------------|
| `show-pencil` | boolean | true | Show pencil tool |
| `show-rectangle` | boolean | true | Show rectangle tool |
| `show-circle` | boolean | true | Show circle tool |
| `show-line` | boolean | true | Show line tool |
| `show-arrow` | boolean | true | Show arrow tool |
| `show-polygon` | boolean | true | Show polygon tool |
| `show-text` | boolean | true | Show text tool |
| `show-image` | boolean | true | Show image import |
| `show-undo` | boolean | true | Show undo button |
| `show-redo` | boolean | true | Show redo button |
| `show-zoom` | boolean | true | Show zoom controls |
| `show-download` | boolean | true | Show PNG export |
| `show-export` | boolean | true | Show JSON save |
| `show-import` | boolean | true | Show JSON load |
| `show-color` | boolean | true | Show color picker |
| `show-clear` | boolean | true | Show clear canvas button |
| `show-layers` | boolean | true | Show layer management |
| `show-group` | boolean | true | Show group/ungroup |
| `show-align` | boolean | true | Show align/distribute |

### ğŸ“Š Initial Data

You can pass JSON data to initialize the canvas content:

```html
<canvas-drawing-editor
  initial-data='{"objects":[{"id":"abc123","type":"RECTANGLE","x":100,"y":100,"width":200,"height":150,"color":"#3b82f6","lineWidth":2}]}'
></canvas-drawing-editor>
```

### ğŸ“¡ Events

#### `editor-change` Event

Fires when canvas content changes. The `e.detail.objects` array contains all drawing objects.

```javascript
document.addEventListener('editor-change', (e) => {
  console.log('Objects:', e.detail.objects);
  // Save to server or localStorage
  localStorage.setItem('canvas-data', JSON.stringify({ objects: e.detail.objects }));
});
```

#### Object Types & Properties

Each object in `e.detail.objects` has the following base properties:

| Property | Type | Description |
|----------|------|-------------|
| `id` | string | Unique identifier |
| `type` | string | Object type: `RECTANGLE`, `CIRCLE`, `PATH`, `TEXT`, `IMAGE`, `LINE`, `ARROW`, `POLYGON`, `GROUP` |
| `x` | number | X coordinate |
| `y` | number | Y coordinate |
| `color` | string | Stroke/fill color (hex format, e.g., `#3b82f6`) |
| `lineWidth` | number | Line width in pixels |
| `visible` | boolean | Visibility (optional, default true) |
| `locked` | boolean | Lock state (optional, default false) |

**Rectangle** (`type: "RECTANGLE"`):
| Property | Type | Description |
|----------|------|-------------|
| `width` | number | Rectangle width |
| `height` | number | Rectangle height |

**Circle** (`type: "CIRCLE"`):
| Property | Type | Description |
|----------|------|-------------|
| `radius` | number | Circle radius |

**Path/Pencil** (`type: "PATH"`):
| Property | Type | Description |
|----------|------|-------------|
| `points` | Array<{x, y}> | Array of point coordinates |

**Line** (`type: "LINE"`):
| Property | Type | Description |
|----------|------|-------------|
| `x2` | number | End point X coordinate |
| `y2` | number | End point Y coordinate |

**Arrow** (`type: "ARROW"`):
| Property | Type | Description |
|----------|------|-------------|
| `x2` | number | End point X coordinate |
| `y2` | number | End point Y coordinate |

**Polygon** (`type: "POLYGON"`):
| Property | Type | Description |
|----------|------|-------------|
| `radius` | number | Circumscribed circle radius |
| `sides` | number | Number of sides (e.g., 3=triangle, 6=hexagon) |

**Text** (`type: "TEXT"`):
| Property | Type | Description |
|----------|------|-------------|
| `text` | string | Text content |
| `fontSize` | number | Font size in pixels |
| `fontFamily` | string | Font family (optional, default sans-serif) |
| `bold` | boolean | Bold style (optional) |
| `italic` | boolean | Italic style (optional) |
| `hotzone` | object | Hotzone config (optional, see Hotzone section) |

**Image** (`type: "IMAGE"`):
| Property | Type | Description |
|----------|------|-------------|
| `width` | number | Image width |
| `height` | number | Image height |
| `dataUrl` | string | Base64 encoded image data |

**Group** (`type: "GROUP"`):
| Property | Type | Description |
|----------|------|-------------|
| `width` | number | Group width |
| `height` | number | Group height |
| `children` | Array | Array of child objects |

#### Example: Saving and Loading

```javascript
// Save canvas content
document.addEventListener('editor-change', (e) => {
  const data = JSON.stringify({ objects: e.detail.objects });
  localStorage.setItem('my-canvas', data);
});

// Load canvas content
const savedData = localStorage.getItem('my-canvas');
if (savedData) {
  document.querySelector('canvas-drawing-editor').setAttribute('initial-data', savedData);
}
```

#### `editor-close` Event

```javascript
document.addEventListener('editor-close', () => {
  console.log('Editor closed');
});
```

#### `animation-start` Event

Triggered when an animation starts.

```javascript
document.addEventListener('animation-start', (e) => {
  console.log('Animation started:', e.detail);
  // e.detail: { tweenId, objectId }
});
```

#### `animation-complete` Event

Triggered when an animation completes.

```javascript
document.addEventListener('animation-complete', (e) => {
  console.log('Animation completed:', e.detail);
  // e.detail: { tweenId, objectId }
});
```

#### `animation-update` Event

Triggered on each animation frame update.

```javascript
document.addEventListener('animation-update', (e) => {
  console.log('Animation progress:', e.detail.progress);
  // e.detail: { tweenId, objectId, progress }
});
```

### ğŸ”¥ Hotzone Feature

The hotzone feature allows you to bind dynamic variables to text objects for template-based dynamic text replacement.

#### Use Cases

1. Design templates (certificates, business cards, posters)
2. Add hotzones to text, bind variable names
3. Pass variable values at runtime to dynamically replace text

#### Admin Mode (Design Templates)

```html
<!-- Enable hotzone editing -->
<canvas-drawing-editor
  title="Template Designer"
  enable-hotzone="true"
></canvas-drawing-editor>
```

Steps:
1. Create text (e.g., "Name")
2. Right-click on text â†’ Select "Create Hotzone"
3. Enter variable name (e.g., `name`) â†’ Save
4. Export JSON to save template

#### User Mode (Display Dynamic Data)

```html
<!-- Pass template data and variable values -->
<canvas-drawing-editor
  initial-data='{"objects":[...]}'
  hotzone-data='{"name": "John Doe", "company": "Acme Inc"}'
></canvas-drawing-editor>
```

#### Hotzone Data Structure

```javascript
// Text object with hotzone config
{
  "type": "TEXT",
  "text": "Name",
  "hotzone": {
    "variableName": "name",       // Variable name (required)
    "defaultValue": "Default",    // Default value (optional)
    "description": "User name"    // Description (optional)
  }
}
```

### ğŸ¬ Tween Animation API

Use `tweenAnimate()` method to create smooth property transition animations:

```javascript
const editor = document.querySelector('canvas-drawing-editor');

// Basic usage
editor.tweenAnimate(objectId, { x: 300, y: 200 }, {
  duration: 1000,        // Animation duration (ms)
  easing: 'easeOutQuad', // Easing function
  onComplete: () => console.log('Animation complete')
});

// Animatable properties: x, y, width, height, rotation, opacity, fontSize, radius

// Easing functions: linear, easeInQuad, easeOutQuad, easeInOutQuad,
//                   easeInElastic, easeOutElastic, easeInBounce, easeOutBounce,
//                   easeInBack, easeOutBack

// Loop animation
editor.tweenAnimate(objectId, { x: 400 }, {
  duration: 1000,
  repeat: -1,    // Infinite loop
  yoyo: true     // Reverse on repeat
});

// Stop animations
editor.stopAllAnimations();
```

### ğŸ› ï¸ Development

```bash
# Install dependencies
npm install

# Start dev server
npm run dev

# Build library
npm run build:lib
```

---

## ğŸ“„ License

MIT Â© typsusan
