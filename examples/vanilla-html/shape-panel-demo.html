<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>形状库 - Shape Library Demo</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
    canvas-drawing-editor { width: 100%; height: 100vh; display: block; }
  </style>
</head>
<body>
  <canvas-drawing-editor
    id="editor"
    title="形状库演示"
    lang="zh"
    theme-color="#5450dc"
  ></canvas-drawing-editor>

  <script src="../../dist/canvas-drawing-editor.umd.js"></script>
  <script>
    const editor = document.getElementById('editor');

    // 页面加载后注册形状
    setTimeout(() => {
      // 调试：检查形状库按钮是否存在
      const shapeLibraryBtn = editor.shadowRoot.querySelector('.shape-library-btn');
      console.log('形状库按钮:', shapeLibraryBtn);

      // 生成时间戳ID
      let idCounter = 0;
      const generateId = () => 'T' + Date.now() + (idCounter++).toString().padStart(3, '0');

      // 生成颜色数组
      const colors = [
        '#3b82f6', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6',
        '#06b6d4', '#ec4899', '#84cc16', '#f97316', '#6366f1',
        '#14b8a6', '#a855f7', '#22c55e', '#eab308', '#0ea5e9'
      ];

      // 形状类型
      const shapeTypes = ['rectangle', 'circle', 'triangle', 'star', 'heart', 'diamond', 'hexagon', 'ellipse', 'roundedRect'];

      // 生成基础形状
      const basicShapes = [];
      for (let i = 0; i < 20; i++) {
        const color = colors[i % colors.length];
        const type = shapeTypes[i % shapeTypes.length];
        basicShapes.push({
          id: `shape-${i + 1}`,
          name: generateId(),
          type: type,
          category: '基础',
          fillColor: color,
          fillMode: 'both',
          strokeColor: color,
          strokeWidth: 2,
          width: 80 + (i % 3) * 20,
          height: 60 + (i % 3) * 20,
          cornerRadius: type === 'roundedRect' ? 8 : 0
        });
      }

      // 生成带文字的按钮形状
      const buttonColors = ['#22c55e', '#ef4444', '#3b82f6', '#8b5cf6', '#f59e0b', '#06b6d4', '#ec4899', '#84cc16'];

      const buttonShapes = [];
      for (let i = 0; i < 20; i++) {
        buttonShapes.push({
          id: `btn-${i + 1}`,
          name: generateId(),
          type: 'roundedRect',
          category: '按钮',
          fillColor: buttonColors[i % buttonColors.length],
          fillMode: 'fill',
          strokeWidth: 0,
          cornerRadius: 8,
          width: 100,
          height: 40,
          text: generateId(),
          textColor: '#ffffff',
          fontSize: 14,
          fontWeight: 'bold'
        });
      }

      // 生成流程图形状
      const flowTypes = ['ellipse', 'ellipse', 'rectangle', 'diamond', 'parallelogram', 'parallelogram', 'rectangle', 'rectangle', 'hexagon', 'rectangle'];

      const flowShapes = [];
      for (let i = 0; i < 10; i++) {
        flowShapes.push({
          id: `flow-${i + 1}`,
          name: generateId(),
          type: flowTypes[i % flowTypes.length],
          category: '流程图',
          fillColor: '#dbeafe',
          fillMode: 'both',
          strokeColor: '#3b82f6',
          strokeWidth: 2,
          width: 100,
          height: i === 3 ? 100 : 60,
          text: generateId(),
          textColor: '#1e40af',
          fontSize: 14
        });
      }

      // 注册所有形状
      editor.registerShapes([...basicShapes, ...buttonShapes, ...flowShapes]);

      console.log('形状已注册！共', basicShapes.length + buttonShapes.length + flowShapes.length, '个形状');
    }, 300);

    // 监听形状添加事件
    editor.addEventListener('shape-added', (e) => {
      console.log('形状已添加到画布:', e.detail.shape.name);
      console.log('创建的对象:', JSON.stringify(e.detail.object, null, 2));
    });
  </script>
</body>
</html>

